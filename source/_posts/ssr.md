---
title: ssr
date: 2020-12-31 15:39:29
tags: ['react', '服务端渲染']
categories: 
    - [react]
    - [服务端渲染]
---

# ssr(server side render)

在现在react，vue等框架出现后，前后端分离大部分页面都是spa应用的今天，为什么还需要服务端渲染技术呢？

说到ssr，我们可以追溯到早期访问一个页面时，古老的jsp、php工程师们会根据页面的请求url，服务器直接生成相应的完整静态页面。而前端的工程师只是给这些静态页面添加一些交互效果，web开发浏览器也只负责展现后端给的页面而已。前后端基本分工基本耦合在一起，因为后端的返回的页面内容依赖于模版引擎，而且模版引擎又依赖后端环境以及相关处理的接口和数据，还不如一个人处理，所以当时基本没有单独的前端工程师，盛行的是后端也就是jsp工程师，一个人负责完整的开发。

和ssr对应的是客户端渲染csr(client side render)，而随着前端技术演进，ajax，node.js以及更加强大的渲染框架如react,vue等，前端分离的架构模式也就顺理成章。
前后端分离的架构中，前端初始加载一个简单html文件，他只有简单的html结构，不包含展示内容，真正的页面逻辑都通过react或者vue等框架打包成一个js包，当html遇到这个js再通过ajax去加载相关代码进行页面渲染和相关的交互处理，从而在客户端渲染出页面逻辑。

两相对比，ssr有其优点

1. 相对于服务端渲染而言，客户端渲染有其弊端，因为大部分爬虫只能爬html页面数据，无法爬到加载的js内容，这样的话搜索引擎就无法爬到客户端渲染的内容，不利于seo，而ssr返回的html是完整页面，能够被搜索引擎更好的爬虫分析和索引。
2. 更快的首屏加载速度：客户端渲染返回的是空白html页面，需要下载js然后执行才能显示内容。而且ssr直接返回html显然有更快的渲染体验。

那么我们现在说的ssr是一种倒退的么？现代服务器渲染的一种实现方式也就是通过应用，node.js的出现使得javascript一套代码在前后端能够统一实现，而react提出的虚拟dom的概念，使得在浏览器才有的dom概念转变为虚拟dom的一种js结构，于是可以通过大量可复用代码实现前后端渲染的一致性，用react代码在服务端先执行一次，使得用户的html包含展示内容，再在客户端再次执行代码，执行其中的事件绑定数据添加等交互能力。这不是简单的面向早期web开发的倒退，而是一种回归式的发展。基于不同业务需求的理念。

1. 在服务器上生成渲染内容：加速首屏和seo搜索.
2. 客户端执行js脚本完成对应的页面绑定、用户交互.

## 基于React的ssr实现

我们先完成一个最简单的ssr应用。首先我们需要搭建一个简单的node.js服务器，对其发送请求可以返回一个完整的html页面


